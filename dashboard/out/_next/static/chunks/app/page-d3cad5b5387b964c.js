(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5892:(e,t,a)=>{Promise.resolve().then(a.bind(a,9931))},9931:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>W});var s,r=a(5155),l=a(2115);let n=null!=(s=a(5704).env.NEXT_PUBLIC_API_URL)?s:"";async function o(e){let t=await fetch("".concat(n).concat(e),{cache:"no-store"});if(!t.ok)throw Error("API error: ".concat(t.status));return t.json()}async function c(e,t,a){let s=await fetch("".concat(n).concat(e),{method:t,headers:a?{"Content-Type":"application/json"}:void 0,body:a?JSON.stringify(a):void 0});if(!s.ok){var r;throw Error(null!=(r=(await s.json().catch(()=>({error:"HTTP ".concat(s.status)}))).error)?r:"API error: ".concat(s.status))}return s.json()}let i=[{key:"mission",label:"Tasks"},{key:"config",label:"Agents"},{key:"roles",label:"Roles"},{key:"skills",label:"Skills"},{key:"documents",label:"Docs"},{key:"knowledge",label:"Knowledge"}];function d(e){let{activeView:t,onViewChange:a}=e,[s,n]=(0,l.useState)(""),[c,d]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{let e=async()=>{try{await o("/agents"),d(!0)}catch(e){d(!1)}};e();let t=setInterval(e,5e3);return()=>clearInterval(t)},[]),(0,l.useEffect)(()=>{let e=()=>{n(new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}))};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[]),(0,r.jsxs)("header",{style:{background:"var(--bg-secondary)",borderBottom:"1px solid var(--border)"},className:"h-14 flex items-center justify-between px-5 shrink-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-7 h-7 rounded-md flex items-center justify-center text-white text-xs font-bold",style:{background:"var(--accent-green)"},children:"A"}),(0,r.jsx)("span",{className:"font-semibold text-sm",children:"Agency"})]}),(0,r.jsx)("nav",{className:"flex gap-1",children:i.map(e=>(0,r.jsx)("button",{onClick:()=>a(e.key),className:"px-3 py-1.5 rounded-md text-sm font-medium transition-colors",style:{background:t===e.key?"var(--bg-tertiary)":"transparent",color:t===e.key?"var(--text-primary)":"var(--text-secondary)"},children:e.label},e.key))})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,r.jsx)("button",{onClick:()=>a("settings"),className:"w-8 h-8 rounded-md flex items-center justify-center transition-colors",style:{background:"settings"===t?"var(--bg-tertiary)":"transparent",color:"settings"===t?"var(--text-primary)":"var(--text-secondary)"},title:"Settings",children:(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M6.86 1.45a1.2 1.2 0 0 1 2.28 0l.2.6a1.2 1.2 0 0 0 1.57.7l.58-.24a1.2 1.2 0 0 1 1.6 1.14l-.02.63a1.2 1.2 0 0 0 1.04 1.22l.62.1a1.2 1.2 0 0 1 .8 1.97l-.43.46a1.2 1.2 0 0 0 0 1.6l.43.46a1.2 1.2 0 0 1-.8 1.97l-.62.1a1.2 1.2 0 0 0-1.04 1.22l.02.63a1.2 1.2 0 0 1-1.6 1.14l-.58-.24a1.2 1.2 0 0 0-1.57.7l-.2.6a1.2 1.2 0 0 1-2.28 0l-.2-.6a1.2 1.2 0 0 0-1.57-.7l-.58.24a1.2 1.2 0 0 1-1.6-1.14l.02-.63a1.2 1.2 0 0 0-1.04-1.22l-.62-.1a1.2 1.2 0 0 1-.8-1.97l.43-.46a1.2 1.2 0 0 0 0-1.6l-.43-.46a1.2 1.2 0 0 1 .8-1.97l.62-.1A1.2 1.2 0 0 0 2.91 4.3l-.02-.63a1.2 1.2 0 0 1 1.6-1.14l.58.24a1.2 1.2 0 0 0 1.57-.7l.2-.6Z"}),(0,r.jsx)("circle",{cx:"8",cy:"8",r:"2.5"})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",style:{color:"var(--text-muted)"},children:[(0,r.jsx)("span",{className:"font-mono text-xs",children:s}),(0,r.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(c?"bg-green-500":"bg-red-500")})]})]})]})}let x={orchestrator:{label:"LEAD",color:"#5c7c5a",bg:"#e8f0e7"},implementer:{label:"INT",color:"#5c6b8c",bg:"#e7ecf0"},specialist:{label:"SPC",color:"#8c6b5c",bg:"#f0ece7"}};function u(e){let{agents:t}=e;return(0,r.jsxs)("div",{className:"w-[200px] shrink-0 overflow-y-auto border-r",style:{borderColor:"var(--border)",background:"var(--bg-secondary)"},children:[(0,r.jsx)("div",{className:"px-4 py-3 text-xs font-bold tracking-wider",style:{color:"var(--text-muted)"},children:"AGENTS"}),(0,r.jsx)("div",{className:"space-y-0.5 px-2",children:t.map(e=>{var t,a;let s=null!=(a=x[t=e.role])?a:{label:t.slice(0,3).toUpperCase(),color:"#6b6b6b",bg:"#f0f0f0"};return(0,r.jsxs)("div",{className:"flex items-center gap-2.5 px-2 py-2 rounded-md hover:bg-black/[0.03] cursor-default",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold shrink-0",style:{background:s.color},children:e.name.charAt(0).toUpperCase()}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full shrink-0 ".concat("active"===e.status?"bg-green-500":"blocked"===e.status?"bg-red-500":"bg-gray-400")}),(0,r.jsx)("span",{className:"text-sm font-semibold truncate",children:e.name})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5 mt-0.5",children:[(0,r.jsx)("span",{className:"text-[10px] font-bold px-1.5 py-0.5 rounded",style:{color:s.color,background:s.bg},children:s.label}),(0,r.jsx)("span",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:e.role})]})]})]},e.id)})})]})}let m={1:"var(--accent-red)",2:"var(--accent-yellow)",3:"var(--border)"};function p(e){var t,a,s,l;let{task:n,onClick:o}=e,c=null==(t=n.assignees)?void 0:t[0],i=null!=(s=n.updated_at)?s:n.created_at;return(0,r.jsxs)("button",{onClick:o,className:"w-full text-left rounded-lg p-3 transition-all hover:shadow-md",style:{background:"var(--bg-secondary)",border:"1px solid var(--border-light)",borderLeft:"3px solid ".concat(null!=(l=m[n.priority])?l:"var(--border)")},children:[(0,r.jsx)("div",{className:"font-semibold text-sm mb-1 leading-snug",children:n.title}),n.description&&(0,r.jsx)("div",{className:"text-xs mb-2 leading-relaxed line-clamp-2",style:{color:"var(--text-secondary)"},children:n.description}),(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[c&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-5 h-5 rounded-full flex items-center justify-center text-white text-[9px] font-bold",style:{background:"var(--accent-blue)"},children:c.name.charAt(0).toUpperCase()}),(0,r.jsx)("span",{className:"text-xs",style:{color:"var(--text-secondary)"},children:c.name})]}),i&&(0,r.jsxs)("span",{className:"text-[11px]",style:{color:"var(--text-muted)"},children:[c?" \xb7 ":"",function(e){let t=Math.floor((Date.now()-new Date(e).getTime())/1e3);if(t<60)return"just now";let a=Math.floor(t/60);if(a<60)return"".concat(a,"m ago");let s=Math.floor(a/60);if(s<24)return"about ".concat(s," hour").concat(s>1?"s":""," ago");let r=Math.floor(s/24);return"".concat(r,"d ago")}(i)]})]})}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[(0,r.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded font-medium",style:{background:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:n.task_type}),null==(a=n.tags)?void 0:a.map(e=>(0,r.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded font-medium",style:{background:"var(--bg-tertiary)",color:"var(--text-muted)"},children:e},e))]})]})}let y=["inbox","assigned","in_progress","review","done"];function h(e){var t;let{taskId:a,onClose:s}=e,[n,i]=(0,l.useState)(null),[d,x]=(0,l.useState)([]),[u,m]=(0,l.useState)(""),[p,h]=(0,l.useState)(!1),[v,b]=(0,l.useState)(""),f=(0,l.useCallback)(()=>{o("/tasks/".concat(a)).then(i).catch(console.error)},[a]);(0,l.useEffect)(()=>{f(),o("/agents").then(x).catch(console.error);let e=setInterval(f,5e3);return()=>clearInterval(e)},[f]);let g=async e=>{await c("/tasks/".concat(a),"PATCH",{status:e,from:"human"}),f()},j=async()=>{v&&(await c("/tasks/".concat(a,"/assign"),"POST",{agentName:v}),b(""),f())},k=async()=>{if(u.trim()){h(!0);try{await c("/tasks/".concat(a,"/messages"),"POST",{from:"human",content:u.trim()}),m(""),f()}catch(e){console.error(e.message)}finally{h(!1)}}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black/20 z-40",onClick:s}),(0,r.jsxs)("div",{className:"fixed inset-y-0 right-0 w-[600px] overflow-y-auto z-50 shadow-xl flex flex-col",style:{background:"var(--bg-secondary)",borderLeft:"1px solid var(--border)"},children:[(0,r.jsxs)("div",{className:"p-6 flex-1 overflow-y-auto",children:[(0,r.jsx)("button",{onClick:s,className:"mb-4 text-sm font-medium px-2 py-1 rounded hover:bg-black/5 transition-colors",style:{color:"var(--text-secondary)"},children:"Close"}),n&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:n.title}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 items-center",children:y.map(e=>(0,r.jsx)("button",{onClick:()=>g(e),className:"px-2 py-1 rounded text-xs font-medium transition-colors",style:{background:n.status===e?"var(--accent-green)":"var(--bg-tertiary)",color:n.status===e?"white":"var(--text-secondary)"},children:e.replace("_"," ")},e))}),(0,r.jsxs)("div",{className:"text-sm",style:{color:"var(--text-secondary)"},children:["Priority: P",n.priority," \xb7 Assignees:"," ",(null==(t=n.assignees)?void 0:t.map(e=>e.name).join(", "))||"none"]}),(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsxs)("select",{value:v,onChange:e=>b(e.target.value),className:"px-2 py-1 rounded text-sm",style:{background:"var(--bg-tertiary)",border:"1px solid var(--border)"},children:[(0,r.jsx)("option",{value:"",children:"Assign agent..."}),d.filter(e=>"human"!==e.name).map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.name))]}),v&&(0,r.jsx)("button",{onClick:j,className:"px-3 py-1 rounded text-xs font-medium text-white",style:{background:"var(--accent-blue)"},children:"Assign"})]}),n.description&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xs font-bold tracking-wider mb-1",style:{color:"var(--text-muted)"},children:"DESCRIPTION"}),(0,r.jsx)("pre",{className:"text-sm whitespace-pre-wrap rounded p-3",style:{background:"var(--bg-tertiary)"},children:n.description})]}),n.design&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xs font-bold tracking-wider mb-1",style:{color:"var(--text-muted)"},children:"DESIGN"}),(0,r.jsx)("pre",{className:"text-sm whitespace-pre-wrap rounded p-3",style:{background:"var(--bg-tertiary)"},children:n.design})]}),n.acceptance&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xs font-bold tracking-wider mb-1",style:{color:"var(--text-muted)"},children:"ACCEPTANCE"}),(0,r.jsx)("pre",{className:"text-sm whitespace-pre-wrap rounded p-3",style:{background:"var(--bg-tertiary)"},children:n.acceptance})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xs font-bold tracking-wider mb-2",style:{color:"var(--text-muted)"},children:"MESSAGES"}),(0,r.jsx)("div",{className:"space-y-2 mb-3",children:n.messages&&n.messages.length>0?n.messages.map((e,t)=>{var a;return(0,r.jsxs)("div",{className:"pl-3",style:{borderLeft:"2px solid var(--border)"},children:[(0,r.jsxs)("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[(0,r.jsx)("span",{className:"font-bold",style:{color:"var(--text-secondary)"},children:null!=(a=e.from_name)?a:"?"})," ","\xb7 ",new Date(e.created_at).toLocaleString()]}),(0,r.jsx)("div",{className:"text-sm mt-0.5",children:e.content})]},t)}):(0,r.jsx)("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No messages yet"})})]})]})]}),n&&(0,r.jsx)("div",{className:"p-4 border-t",style:{borderColor:"var(--border)",background:"var(--bg-secondary)"},children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:u,onChange:e=>m(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),k())},placeholder:"Write a message...",className:"flex-1 px-3 py-2 rounded-md text-sm",style:{background:"var(--bg-tertiary)",border:"1px solid var(--border)"}}),(0,r.jsx)("button",{onClick:k,disabled:p||!u.trim(),className:"px-4 py-2 rounded-md text-sm font-medium text-white",style:{background:"var(--accent-green)",opacity:p||!u.trim()?.5:1},children:p?"...":"Send"})]})})]})]})}function v(e){let{open:t,onClose:a,onCreated:s}=e,[n,i]=(0,l.useState)(""),[d,x]=(0,l.useState)(""),[u,m]=(0,l.useState)(2),[p,y]=(0,l.useState)("task"),[h,v]=(0,l.useState)(""),[b,f]=(0,l.useState)([]),[g,j]=(0,l.useState)(null),[k,N]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{t&&o("/agents").then(f).catch(console.error)},[t]),!t)return null;let w=async e=>{e.preventDefault(),j(null),N(!0);try{await c("/tasks","POST",{title:n,description:d,from:"human",priority:u,task_type:p,...h?{assign:h}:{}}),i(""),x(""),m(2),y("task"),v(""),s(),a()}catch(e){j(e.message)}finally{N(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0,0,0,0.5)"},onClick:a,children:(0,r.jsxs)("form",{onClick:e=>e.stopPropagation(),onSubmit:w,className:"rounded-lg shadow-xl w-[480px] max-h-[90vh] overflow-y-auto",style:{background:"var(--bg-primary)",border:"1px solid var(--border)"},children:[(0,r.jsx)("div",{className:"px-5 py-4 border-b",style:{borderColor:"var(--border)"},children:(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Create Task"})}),(0,r.jsxs)("div",{className:"px-5 py-4 space-y-4",children:[g&&(0,r.jsx)("div",{className:"text-sm px-3 py-2 rounded",style:{background:"#fef2f2",color:"#dc2626"},children:g}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Title"}),(0,r.jsx)("input",{type:"text",value:n,onChange:e=>i(e.target.value),placeholder:"Task title",required:!0,className:"w-full px-3 py-2 rounded-md text-sm",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Description"}),(0,r.jsx)("textarea",{value:d,onChange:e=>x(e.target.value),placeholder:"Describe the task...",required:!0,rows:4,className:"w-full px-3 py-2 rounded-md text-sm resize-y",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Priority"}),(0,r.jsx)("div",{className:"flex gap-3",children:[1,2,3].map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-1.5 text-sm cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",name:"priority",value:e,checked:u===e,onChange:()=>m(e)}),"P",e]},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Type"}),(0,r.jsx)("div",{className:"flex gap-3",children:["task","bug","feature"].map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-1.5 text-sm cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",name:"task_type",value:e,checked:p===e,onChange:()=>y(e)}),e.charAt(0).toUpperCase()+e.slice(1)]},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Assign to (optional)"}),(0,r.jsxs)("select",{value:h,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 rounded-md text-sm",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"},children:[(0,r.jsx)("option",{value:"",children:"Unassigned"}),b.filter(e=>"human"!==e.name).map(e=>(0,r.jsxs)("option",{value:e.name,children:[e.name," (",e.role,")"]},e.id))]})]})]}),(0,r.jsxs)("div",{className:"px-5 py-3 flex justify-end gap-2 border-t",style:{borderColor:"var(--border)"},children:[(0,r.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 rounded-md text-sm font-medium",style:{background:"var(--bg-tertiary)"},children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:k,className:"px-4 py-2 rounded-md text-sm font-medium text-white",style:{background:"var(--accent-green)",opacity:k?.6:1},children:k?"Creating...":"Create Task"})]})]})})}let b=["inbox","assigned","in_progress","review","done"],f={inbox:"INBOX",assigned:"ASSIGNED",in_progress:"IN PROGRESS",review:"REVIEW",done:"DONE"};function g(){let[e,t]=(0,l.useState)([]),[a,s]=(0,l.useState)(null),[n,c]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{let e=()=>o("/tasks").then(t).catch(console.error);e();let a=setInterval(e,5e3);return()=>clearInterval(a)},[]),(0,r.jsxs)("div",{className:"flex-1 overflow-x-auto p-4",children:[(0,r.jsx)("div",{className:"flex gap-4 min-w-0",children:b.map(t=>{let a=e.filter(e=>e.status===t);return(0,r.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3 px-1",children:[(0,r.jsx)("h3",{className:"text-xs font-bold tracking-wider",style:{color:"var(--text-muted)"},children:f[t]}),"inbox"===t&&(0,r.jsx)("button",{onClick:()=>c(!0),className:"w-5 h-5 flex items-center justify-center rounded text-xs font-bold leading-none",style:{background:"var(--bg-tertiary)",color:"var(--text-secondary)"},title:"Create task",children:"+"}),(0,r.jsx)("span",{className:"text-[11px] font-medium px-1.5 rounded-full",style:{background:"var(--bg-tertiary)",color:"var(--text-muted)"},children:a.length})]}),(0,r.jsx)("div",{className:"space-y-2",children:a.map(e=>(0,r.jsx)(p,{task:e,onClick:()=>s(e.id)},e.id))})]},t)})}),a&&(0,r.jsx)(h,{taskId:a,onClose:()=>s(null)}),(0,r.jsx)(v,{open:n,onClose:()=>c(!1),onCreated:()=>o("/tasks").then(t).catch(console.error)})]})}let j=["All","Tasks","Comments","Status"],k={Tasks:["task_created","assigned","document_created"],Comments:["message"],Status:["status_changed"]};function N(){let[e,t]=(0,l.useState)([]),[a,s]=(0,l.useState)("All"),[n,c]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=()=>o("/activities?limit=50").then(t).catch(console.error);e();let a=setInterval(e,5e3);return()=>clearInterval(a)},[]);let i=[...new Set(e.map(e=>e.agent_name).filter(Boolean))],d=e.filter(e=>{if(n&&e.agent_name!==n)return!1;if("All"!==a){let t=k[a];if(t&&e.type&&!t.includes(e.type))return!1}return!0});return(0,r.jsxs)("div",{className:"w-[300px] shrink-0 overflow-y-auto border-l flex flex-col",style:{borderColor:"var(--border)",background:"var(--bg-secondary)"},children:[(0,r.jsxs)("div",{className:"px-4 py-3",children:[(0,r.jsx)("div",{className:"text-xs font-bold tracking-wider mb-3",style:{color:"var(--text-muted)"},children:"LIVE FEED"}),(0,r.jsx)("div",{className:"flex gap-1 mb-3",children:j.map(e=>(0,r.jsx)("button",{onClick:()=>s(e),className:"px-2 py-1 rounded text-xs font-medium transition-colors",style:{background:a===e?"var(--bg-tertiary)":"transparent",color:a===e?"var(--text-primary)":"var(--text-muted)"},children:e},e))}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-1 mb-3",children:[(0,r.jsx)("button",{onClick:()=>c(null),className:"px-2 py-0.5 rounded-full text-[11px] font-medium transition-colors",style:{background:null===n?"var(--accent-green)":"var(--bg-tertiary)",color:null===n?"white":"var(--text-secondary)"},children:"All Agents"}),i.map(e=>(0,r.jsx)("button",{onClick:()=>c(e),className:"px-2 py-0.5 rounded-full text-[11px] font-medium transition-colors",style:{background:n===e?"var(--accent-green)":"var(--bg-tertiary)",color:n===e?"white":"var(--text-secondary)"},children:e},e))]})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto px-4 pb-4 space-y-3",children:[d.map(e=>{var t,a;return(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-white text-[10px] font-bold shrink-0 mt-0.5",style:{background:"var(--accent-olive)"},children:(null!=(t=e.agent_name)?t:"S").charAt(0).toUpperCase()}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-semibold",children:null!=(a=e.agent_name)?a:"system"})," ",(0,r.jsx)("span",{style:{color:"var(--text-secondary)"},children:e.summary})]}),(0,r.jsx)("div",{className:"text-[11px]",style:{color:"var(--text-muted)"},children:function(e){let t=Math.floor((Date.now()-new Date(e).getTime())/1e3);if(t<60)return"just now";let a=Math.floor(t/60);if(a<60)return"".concat(a,"m ago");let s=Math.floor(a/60);if(s<24)return"".concat(s,"h ago");let r=Math.floor(s/24);return"".concat(r,"d ago")}(e.created_at)})]})]},e.id)}),0===d.length&&(0,r.jsx)("div",{className:"text-sm text-center py-8",style:{color:"var(--text-muted)"},children:"No activity yet"})]})]})}function w(e){let{content:t,filename:a}=e,s=t.split("\n");return(0,r.jsx)("div",{className:"flex-1 overflow-auto font-mono text-sm",style:{background:"var(--bg-primary)"},children:(0,r.jsx)("div",{className:"p-4",children:s.map((e,t)=>(0,r.jsxs)("div",{className:"flex leading-6 hover:bg-black/[0.02]",children:[(0,r.jsx)("span",{className:"w-12 text-right pr-4 select-none shrink-0",style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:t+1}),(0,r.jsx)("span",{className:"flex-1 whitespace-pre-wrap break-all",children:function(e){if(e.startsWith("# "))return(0,r.jsx)("span",{style:{color:"var(--accent-green)",fontWeight:700,fontSize:"1.1em"},children:e});if(e.startsWith("## "))return(0,r.jsx)("span",{style:{color:"var(--accent-blue)",fontWeight:700},children:e});if(e.startsWith("### "))return(0,r.jsx)("span",{style:{color:"var(--accent-olive)",fontWeight:600},children:e});if(e.startsWith("- ")||e.startsWith("* "))return(0,r.jsx)("span",{style:{color:"var(--text-primary)"},children:e});if(e.startsWith("```"))return(0,r.jsx)("span",{style:{color:"var(--text-muted)"},children:e});let t=e.split(/(\*\*[^*]+\*\*)/g);return t.length>1?(0,r.jsx)(r.Fragment,{children:t.map((e,t)=>e.startsWith("**")&&e.endsWith("**")?(0,r.jsx)("strong",{children:e.slice(2,-2)},t):(0,r.jsx)("span",{children:e},t))}):(0,r.jsx)("span",{children:e})}(e)})]},t))})})}function S(e){let{open:t,onClose:a,onCreated:s}=e,[n,i]=(0,l.useState)(""),[d,x]=(0,l.useState)(""),[u,m]=(0,l.useState)([]),[p,y]=(0,l.useState)("docker"),[h,v]=(0,l.useState)(!1),[b,f]=(0,l.useState)(""),[g,j]=(0,l.useState)(""),[k,N]=(0,l.useState)(null),[w,S]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{t&&o("/agents/roles").then(e=>{m(e),e.length>0&&!d&&x(e[0])})},[t]),!t)return null;let C=async e=>{e.preventDefault(),N(null),S(!0);try{await c("/agents","POST",{name:n,role:d,location:p,...b?{slack_bot_token:b}:{},...g?{slack_app_token:g}:{}}),i(""),f(""),j(""),v(!1),s(),a()}catch(e){N(e.message)}finally{S(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0,0,0,0.5)"},onClick:a,children:(0,r.jsxs)("form",{onClick:e=>e.stopPropagation(),onSubmit:C,className:"rounded-lg shadow-xl w-[420px] max-h-[90vh] overflow-y-auto",style:{background:"var(--bg-primary)",border:"1px solid var(--border)"},children:[(0,r.jsx)("div",{className:"px-5 py-4 border-b",style:{borderColor:"var(--border)"},children:(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Create Agent"})}),(0,r.jsxs)("div",{className:"px-5 py-4 space-y-4",children:[k&&(0,r.jsx)("div",{className:"text-sm px-3 py-2 rounded",style:{background:"#fef2f2",color:"#dc2626"},children:k}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Name"}),(0,r.jsx)("input",{type:"text",value:n,onChange:e=>i(e.target.value),placeholder:"my-agent",required:!0,pattern:"^[a-z][a-z0-9-]{1,30}$",className:"w-full px-3 py-2 rounded-md text-sm",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"}}),(0,r.jsx)("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Lowercase letters, numbers, hyphens. 2-31 chars."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Role"}),(0,r.jsx)("select",{value:d,onChange:e=>x(e.target.value),required:!0,className:"w-full px-3 py-2 rounded-md text-sm",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"},children:u.map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Location"}),(0,r.jsx)("div",{className:"flex gap-3",children:["docker","ec2","local"].map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-1.5 text-sm cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",name:"location",value:e,checked:p===e,onChange:()=>y(e)}),e.charAt(0).toUpperCase()+e.slice(1)]},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("button",{type:"button",onClick:()=>v(!h),className:"text-sm font-medium flex items-center gap-1",style:{color:"var(--text-secondary)"},children:[(0,r.jsx)("span",{style:{display:"inline-block",transform:h?"rotate(90deg)":"none",transition:"transform 0.15s"},children:"▶"}),"Slack Configuration"]}),h&&(0,r.jsxs)("div",{className:"mt-2 space-y-3 pl-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Bot Token"}),(0,r.jsx)("input",{type:"password",value:b,onChange:e=>f(e.target.value),placeholder:"xoxb-...",className:"w-full px-3 py-1.5 rounded-md text-sm",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium mb-1",children:"App Token"}),(0,r.jsx)("input",{type:"password",value:g,onChange:e=>j(e.target.value),placeholder:"xapp-...",className:"w-full px-3 py-1.5 rounded-md text-sm",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"}})]})]})]})]}),(0,r.jsxs)("div",{className:"px-5 py-3 flex justify-end gap-2 border-t",style:{borderColor:"var(--border)"},children:[(0,r.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 rounded-md text-sm font-medium",style:{background:"var(--bg-tertiary)"},children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:w,className:"px-4 py-2 rounded-md text-sm font-medium text-white",style:{background:"var(--accent-green)",opacity:w?.6:1},children:w?"Creating...":"Create"})]})]})})}function C(e){var t,a;let{agent:s,onRefresh:n}=e,[o,i]=(0,l.useState)(!1),[d,x]=(0,l.useState)(!1),[u,m]=(0,l.useState)(!1),[p,y]=(0,l.useState)(!1),[h,v]=(0,l.useState)(null),[b,f]=(0,l.useState)(null!=(t=s.slack_bot_token)?t:""),[g,j]=(0,l.useState)(null!=(a=s.slack_app_token)?a:""),[k,N]=(0,l.useState)(!1),w=async()=>{i(!0),v(null);try{var e;let t=await c("/agents/".concat(s.name,"/deploy"),"POST");v(null!=(e=t.instructions)?e:"Deployed (".concat(t.method,")")),n()}catch(e){v(e.message)}finally{i(!1)}},S=async()=>{x(!0),v(null);try{await c("/agents/".concat(s.name,"/stop"),"POST"),v("Stopped"),n()}catch(e){v(e.message)}finally{x(!1)}},C=async()=>{m(!0);try{await c("/agents/".concat(s.name),"DELETE"),n()}catch(e){v(e.message),m(!1)}},_=async()=>{N(!0);try{await c("/agents/".concat(s.name),"PATCH",{slack_bot_token:b||null,slack_app_token:g||null}),v("Slack tokens saved"),n()}catch(e){v(e.message)}finally{N(!1)}},E="active"===s.status?"#22c55e":"blocked"===s.status?"#ef4444":"#9ca3af";return(0,r.jsxs)("div",{className:"p-5 space-y-4 border-b",style:{borderColor:"var(--border)"},children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:E}}),(0,r.jsx)("span",{className:"font-semibold",children:s.name}),(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-tertiary)",color:"var(--text-muted)"},children:s.role}),s.location&&(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-tertiary)",color:"var(--text-muted)"},children:s.location})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:w,disabled:o,className:"px-3 py-1.5 rounded-md text-xs font-medium text-white",style:{background:"#22c55e",opacity:o?.6:1},children:o?"Deploying...":"Deploy"}),(0,r.jsx)("button",{onClick:S,disabled:d,className:"px-3 py-1.5 rounded-md text-xs font-medium text-white",style:{background:"#f59e0b",opacity:d?.6:1},children:d?"Stopping...":"Stop"}),p?(0,r.jsx)("button",{onClick:C,disabled:u,className:"px-3 py-1.5 rounded-md text-xs font-medium text-white",style:{background:"#dc2626",opacity:u?.6:1},children:u?"Deleting...":"Confirm Delete"}):(0,r.jsx)("button",{onClick:()=>y(!0),className:"px-3 py-1.5 rounded-md text-xs font-medium text-white",style:{background:"#ef4444"},children:"Delete"})]})]}),h&&(0,r.jsx)("div",{className:"text-sm px-3 py-2 rounded",style:{background:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:h}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-xs font-medium",style:{color:"var(--text-muted)"},children:"Slack Tokens"}),(0,r.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,r.jsx)("input",{type:"password",value:b,onChange:e=>f(e.target.value),placeholder:"Bot Token",className:"flex-1 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"}}),(0,r.jsx)("input",{type:"password",value:g,onChange:e=>j(e.target.value),placeholder:"App Token",className:"flex-1 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"}}),(0,r.jsx)("button",{onClick:_,disabled:k,className:"px-3 py-1.5 rounded text-xs font-medium",style:{background:"var(--bg-tertiary)"},children:k?"Saving...":"Save"})]})]})]})}let _=[{label:"Soul",file:"SOUL.md"},{label:"User",file:"USER.md"},{label:"Agents",file:"AGENTS.md"},{label:"Memory",file:"MEMORY.md"},{label:"Tools",file:"TOOLS.md"}];function E(e){let{agents:t}=e,[a,s]=(0,l.useState)(t),[n,c]=(0,l.useState)(null),[i,d]=(0,l.useState)(_[0].file),[x,u]=(0,l.useState)(""),[m,p]=(0,l.useState)(!1),[y,h]=(0,l.useState)(null),[v,b]=(0,l.useState)(!1),f=a.find(e=>e.name===n),g=(0,l.useCallback)(async()=>{try{let e=await o("/agents");s(e)}catch(e){}},[]);return(0,l.useEffect)(()=>{!n&&a.length>0&&c(a[0].name)},[a,n]),(0,l.useEffect)(()=>{n&&(p(!0),h(null),o("/agents/".concat(n,"/files/").concat(i)).then(e=>{u(e.content),p(!1)}).catch(e=>{h("File not found"),u(""),p(!1)}))},[n,i]),(0,r.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,r.jsxs)("div",{className:"w-[240px] shrink-0 overflow-y-auto border-r",style:{borderColor:"var(--border)",background:"var(--bg-secondary)"},children:[(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs font-bold tracking-wider",style:{color:"var(--text-muted)"},children:"AGENTS"}),(0,r.jsx)("button",{onClick:()=>b(!0),className:"w-6 h-6 rounded flex items-center justify-center text-sm font-bold",style:{background:"var(--bg-tertiary)",color:"var(--text-secondary)"},title:"Create agent",children:"+"})]}),(0,r.jsx)("div",{className:"space-y-0.5 px-2",children:a.map(e=>(0,r.jsxs)("button",{onClick:()=>{c(e.name),d(_[0].file)},className:"w-full flex items-center gap-2.5 px-2 py-2 rounded-md text-left transition-colors",style:{background:n===e.name?"var(--bg-tertiary)":"transparent"},children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold shrink-0",style:{background:"var(--accent-green)"},children:e.name.charAt(0).toUpperCase()}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full shrink-0 ".concat("active"===e.status?"bg-green-500":"blocked"===e.status?"bg-red-500":"bg-gray-400")}),(0,r.jsx)("span",{className:"text-sm font-semibold truncate",children:e.name})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5 mt-0.5",children:[(0,r.jsx)("span",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:e.role}),e.location&&(0,r.jsx)("span",{className:"text-[10px] px-1 py-0.5 rounded",style:{background:"var(--bg-tertiary)",color:"var(--text-muted)"},children:e.location})]})]})]},e.id))})]}),(0,r.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden",children:f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C,{agent:f,onRefresh:()=>{g(),a.find(e=>e.name===n)||c(null)}}),(0,r.jsx)("div",{className:"flex gap-0 border-b px-4",style:{borderColor:"var(--border)",background:"var(--bg-secondary)"},children:_.map(e=>(0,r.jsxs)("button",{onClick:()=>d(e.file),className:"px-3 py-2 text-sm font-medium transition-colors relative",style:{color:i===e.file?"var(--text-primary)":"var(--text-muted)"},children:[e.label,i===e.file&&(0,r.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{background:"var(--accent-green)"}})]},e.file))}),m?(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",style:{color:"var(--text-muted)"},children:"Loading..."}):y?(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",style:{color:"var(--text-muted)"},children:y}):(0,r.jsx)(w,{content:x,filename:i})]}):(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",style:{color:"var(--text-muted)"},children:"Select an agent"})}),(0,r.jsx)(S,{open:v,onClose:()=>b(!1),onCreated:()=>{g()}})]})}let T="********",A=[{id:"identity",label:"Identity"},{id:"ai",label:"AI Provider"},{id:"agent",label:"Agent Defaults"},{id:"aws",label:"AWS"},{id:"ssh",label:"SSH"}],D=[{label:"Model",keys:["agent.model","agent.model_fallbacks","agent.thinking"]},{label:"Execution",keys:["agent.timeout_seconds","agent.max_concurrent","agent.heartbeat_interval"]},{label:"Tools",keys:["agent.tools_profile","agent.tools_allow","agent.tools_deny","agent.web_search","agent.exec_timeout_sec"]},{label:"Sandbox",keys:["agent.sandbox_mode","agent.sandbox_scope"]},{label:"Memory",keys:["agent.context_pruning","agent.compaction"]},{label:"Browser & Logging",keys:["agent.browser_enabled","agent.logging_level","agent.logging_redact"]}],I=new Set(["ai.oauth_access_token","ai.oauth_refresh_token","ai.oauth_expires_at","ai.oauth_subscription_type","ai.auth_method"]);function P(){var e;let[t,a]=(0,l.useState)([]),[s,n]=(0,l.useState)("identity"),[i,d]=(0,l.useState)({}),[x,u]=(0,l.useState)(null),[m,p]=(0,l.useState)(new Set),[y,h]=(0,l.useState)("api_key"),v=(0,l.useCallback)(()=>{o("/settings").then(e=>{a(e);let t=e.find(e=>"ai.auth_method"===e.key);(null==t?void 0:t.value)&&t.value!==T&&h(t.value)}).catch(console.error)},[]);(0,l.useEffect)(()=>{v()},[v]);let b=t.filter(e=>e.category===s),f=async e=>{let t=i[e];if(void 0!==t){u(e);try{await c("/settings/".concat(e),"PUT",{value:t}),v(),d(t=>{let a={...t};return delete a[e],a})}catch(e){console.error(e.message)}finally{u(null)}}},g=async e=>{h(e),await c("/settings/ai.auth_method","PUT",{value:e}),v()},[j,k]=(0,l.useState)(null),[N,w]=(0,l.useState)(!1),S=async()=>{w(!0),k(null);try{(await c("/oauth/claude/import","POST")).ok&&(h("oauth"),v())}catch(e){k(e.message)}finally{w(!1)}},C=async()=>{k(null);try{let e=await o("/oauth/claude/authorize");if(e.error)return void k(e.error);if(e.url){window.open(e.url,"claude-oauth","width=600,height=700");let t=setInterval(()=>{o("/settings?category=ai").then(e=>{let a=e.find(e=>"ai.oauth_access_token"===e.key);a&&a.value===T&&(clearInterval(t),v())})},2e3);setTimeout(()=>clearInterval(t),12e4)}}catch(e){k(e.message)}},_=async()=>{for(let e of["ai.oauth_access_token","ai.oauth_refresh_token","ai.oauth_expires_at","ai.oauth_subscription_type"])await c("/settings/".concat(e),"PUT",{value:""});await c("/settings/ai.auth_method","PUT",{value:"api_key"}),h("api_key"),v()},E=e=>{var t;let a=void 0!==i[e.key],s=null!=(t=i[e.key])?t:e.value,l=a&&i[e.key]!==e.value;if(e.input_type.startsWith("select:")){let t=e.input_type.slice(7).split(",");return(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("select",{value:s,onChange:t=>d(a=>({...a,[e.key]:t.target.value})),className:"flex-1 px-3 py-2 rounded-md text-sm",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"},children:t.map(e=>(0,r.jsx)("option",{value:e,children:e},e))}),l&&(0,r.jsx)(O,{keyName:e.key,saving:x,onSave:f})]})}if("readonly"===e.input_type)return(0,r.jsx)("span",{className:"text-sm px-3 py-2 block",style:{color:"var(--text-secondary)"},children:e.value||"—"});if("textarea"===e.input_type)return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("textarea",{value:s,onChange:t=>d(a=>({...a,[e.key]:t.target.value})),placeholder:e.sensitive?"Paste your private key":"",rows:8,className:"w-full px-3 py-2 rounded-md text-sm font-mono",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)",resize:"vertical"}}),l&&(0,r.jsx)(O,{keyName:e.key,saving:x,onSave:f})]});if("password"===e.input_type){let t=m.has(e.key);return(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("div",{className:"flex-1 relative",children:[(0,r.jsx)("input",{type:t?"text":"password",value:s,onChange:t=>d(a=>({...a,[e.key]:t.target.value})),onFocus:()=>{a||e.value!==T||d(t=>({...t,[e.key]:""}))},placeholder:e.value===T?"••••••••":"",className:"w-full px-3 py-2 rounded-md text-sm pr-10",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"}}),(0,r.jsx)("button",{type:"button",onClick:()=>{var t;return t=e.key,void p(e=>{let a=new Set(e);return a.has(t)?a.delete(t):a.add(t),a})},className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs px-1",style:{color:"var(--text-muted)"},children:t?"Hide":"Show"})]}),l&&(0,r.jsx)(O,{keyName:e.key,saving:x,onSave:f})]})}return(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:s,onChange:t=>d(a=>({...a,[e.key]:t.target.value})),className:"flex-1 px-3 py-2 rounded-md text-sm",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"}}),l&&(0,r.jsx)(O,{keyName:e.key,saving:x,onSave:f})]})};return(0,r.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,r.jsxs)("div",{className:"w-[200px] shrink-0 overflow-y-auto border-r",style:{borderColor:"var(--border)",background:"var(--bg-secondary)"},children:[(0,r.jsx)("div",{className:"px-4 py-3 text-xs font-bold tracking-wider",style:{color:"var(--text-muted)"},children:"CATEGORIES"}),(0,r.jsx)("div",{className:"space-y-0.5 px-2",children:A.map(e=>(0,r.jsx)("button",{onClick:()=>n(e.id),className:"w-full text-left px-3 py-2 rounded-md text-sm font-medium transition-colors",style:{background:s===e.id?"var(--bg-tertiary)":"transparent",color:s===e.id?"var(--text-primary)":"var(--text-secondary)"},children:e.label},e.id))})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold mb-4",children:[null==(e=A.find(e=>e.id===s))?void 0:e.label," Settings"]}),(()=>{if("ai"===s)return(()=>{let e=b.find(e=>"ai.anthropic_api_key"===e.key),a=t.find(e=>"ai.oauth_access_token"===e.key),s=t.find(e=>"ai.oauth_expires_at"===e.key),l=t.find(e=>"ai.oauth_subscription_type"===e.key),n=(null==a?void 0:a.value)===T,o=null!=s&&!!s.value&&new Date(s.value)<new Date;return(0,r.jsxs)("div",{className:"space-y-6 max-w-xl",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"Authentication Method"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>g("api_key"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors",style:{background:"api_key"===y?"var(--accent-blue)":"var(--bg-secondary)",color:"api_key"===y?"white":"var(--text-secondary)",border:"1px solid var(--border)"},children:"API Key"}),(0,r.jsx)("button",{onClick:()=>g("oauth"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors",style:{background:"oauth"===y?"var(--accent-blue)":"var(--bg-secondary)",color:"oauth"===y?"white":"var(--text-secondary)",border:"1px solid var(--border)"},children:"Claude Max OAuth"})]})]}),"api_key"===y&&e&&(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:e.key}),e.description&&(0,r.jsx)("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:e.description}),E(e)]}),"oauth"===y&&(0,r.jsxs)("div",{className:"rounded-lg p-4 space-y-3",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"},children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:"Claude OAuth Status"}),j&&(0,r.jsx)("div",{className:"text-sm px-3 py-2 rounded-md",style:{background:"rgba(255,0,0,0.1)",color:"var(--accent-red, #ef4444)"},children:j}),!n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Not connected"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:S,disabled:N,className:"px-4 py-2 rounded-md text-sm font-medium text-white",style:{background:"var(--accent-blue)",opacity:N?.6:1},children:N?"Importing...":"Import from Claude Code"}),(0,r.jsx)("button",{onClick:C,className:"px-4 py-2 rounded-md text-sm font-medium",style:{background:"var(--bg-tertiary)",color:"var(--text-secondary)",border:"1px solid var(--border)"},children:"Connect with OAuth"})]})]}),n&&!o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-sm",style:{color:"var(--accent-green)"},children:"Connected"}),(null==l?void 0:l.value)&&(0,r.jsxs)("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["Subscription: ",l.value]}),(null==s?void 0:s.value)&&(0,r.jsxs)("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["Expires: ",new Date(s.value).toLocaleString()]}),(0,r.jsx)("button",{onClick:_,className:"px-3 py-1.5 rounded-md text-xs font-medium",style:{background:"var(--bg-tertiary)",color:"var(--text-secondary)",border:"1px solid var(--border)"},children:"Disconnect"})]}),n&&o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-sm",style:{color:"var(--accent-yellow, orange)"},children:"Token expired"}),(0,r.jsx)("button",{onClick:C,className:"px-4 py-2 rounded-md text-sm font-medium text-white",style:{background:"var(--accent-blue)"},children:"Reconnect"})]})]})]})})();if("agent"===s){let e=new Map(b.map(e=>[e.key,e]));return(0,r.jsxs)("div",{className:"space-y-6 max-w-xl",children:[(0,r.jsx)("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"These settings configure all OpenClaw agent instances. Changes take effect on next deploy."}),D.map(t=>{let a=t.keys.map(t=>e.get(t)).filter(Boolean);return 0===a.length?null:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs font-bold tracking-wider mb-3 pb-1 border-b",style:{color:"var(--text-muted)",borderColor:"var(--border)"},children:t.label.toUpperCase()}),(0,r.jsx)("div",{className:"space-y-4",children:a.map(e=>(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:e.key.replace("agent.","")}),e.description&&(0,r.jsx)("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:e.description}),E(e)]},e.key))})]},t.label)})]})}let e=b.filter(e=>!I.has(e.key));return(0,r.jsxs)("div",{className:"space-y-4 max-w-xl",children:[e.map(e=>(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:e.key}),e.description&&(0,r.jsx)("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:e.description}),E(e)]},e.key)),0===e.length&&(0,r.jsx)("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:"No settings in this category."})]})})()]})]})}function O(e){let{keyName:t,saving:a,onSave:s}=e;return(0,r.jsx)("button",{onClick:()=>s(t),disabled:a===t,className:"px-3 py-2 rounded-md text-xs font-medium text-white shrink-0",style:{background:"var(--accent-green)",opacity:a===t?.6:1},children:a===t?"Saving...":"Save"})}function L(){let[e,t]=(0,l.useState)([]),[a,s]=(0,l.useState)(null),[n,i]=(0,l.useState)(""),[d,x]=(0,l.useState)(!1),[u,m]=(0,l.useState)(!1),[p,y]=(0,l.useState)(""),[h,v]=(0,l.useState)(""),[b,f]=(0,l.useState)("installed"),[g,j]=(0,l.useState)([]),[k,N]=(0,l.useState)(!1),[w,S]=(0,l.useState)(new Set);(0,l.useEffect)(()=>{C()},[]);let C=()=>{let e=h?"?search=".concat(encodeURIComponent(h)):"";o("/skills".concat(e)).then(t).catch(console.error)};(0,l.useEffect)(()=>{C()},[h]),(0,l.useEffect)(()=>{"available"!==b||0!==g.length||k||_()},[b]);let _=e=>{N(!0),o("/skills/available".concat(e?"?refresh=1":"")).then(j).catch(console.error).finally(()=>N(!1))},E=e.find(e=>e.id===a);(0,l.useEffect)(()=>{E&&i(E.body)},[a]);let T=async()=>{if(a){x(!0);try{await c("/skills/".concat(a),"PUT",{body:n}),t(e=>e.map(e=>e.id===a?{...e,body:n}:e))}catch(e){console.error(e.message)}finally{x(!1)}}},A=async()=>{if(p.trim())try{let e=await c("/skills","POST",{name:p,body:"# ".concat(p,"\n")});t(t=>[...t,e]),s(e.id),y(""),m(!1)}catch(e){console.error(e.message)}},D=async e=>{try{await c("/skills/".concat(e),"DELETE"),t(t=>t.filter(t=>t.id!==e)),a===e&&(s(null),i(""))}catch(e){console.error(e.message)}},I=async e=>{S(t=>new Set(t).add(e.name));try{var t;(null==(t=(await c("/skills/import","POST",{url:"https://github.com/".concat(e.repo),skills:[e.name]})).imported)?void 0:t.length)&&C()}catch(e){console.error(e.message)}finally{S(t=>{let a=new Set(t);return a.delete(e.name),a})}},P=new Set(e.map(e=>e.name)),O=E&&n!==E.body,L=h?g.filter(e=>e.name.toLowerCase().includes(h.toLowerCase())||e.description.toLowerCase().includes(h.toLowerCase())):g;return(0,r.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,r.jsxs)("div",{className:"w-[260px] shrink-0 overflow-y-auto border-r flex flex-col",style:{borderColor:"var(--border)",background:"var(--bg-secondary)"},children:[(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs font-bold tracking-wider",style:{color:"var(--text-muted)"},children:"SKILLS"}),"installed"===b&&(0,r.jsx)("button",{onClick:()=>m(!0),className:"w-6 h-6 rounded flex items-center justify-center text-sm font-bold",style:{background:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:"+"}),"available"===b&&(0,r.jsx)("button",{onClick:()=>_(!0),className:"px-1.5 h-6 rounded flex items-center justify-center text-xs",style:{background:"var(--bg-tertiary)",color:"var(--text-secondary)"},title:"Refresh",children:"Refresh"})]}),(0,r.jsxs)("div",{className:"flex mx-3 mb-2 rounded overflow-hidden",style:{background:"var(--bg-primary)",border:"1px solid var(--border)"},children:[(0,r.jsxs)("button",{onClick:()=>f("installed"),className:"flex-1 px-2 py-1.5 text-xs font-medium transition-colors",style:{background:"installed"===b?"var(--bg-tertiary)":"transparent",color:"installed"===b?"var(--text-primary)":"var(--text-muted)"},children:["Installed (",e.length,")"]}),(0,r.jsx)("button",{onClick:()=>f("available"),className:"flex-1 px-2 py-1.5 text-xs font-medium transition-colors",style:{background:"available"===b?"var(--bg-tertiary)":"transparent",color:"available"===b?"var(--text-primary)":"var(--text-muted)"},children:"Available"})]}),(0,r.jsx)("div",{className:"px-3 pb-2",children:(0,r.jsx)("input",{type:"text",value:h,onChange:e=>v(e.target.value),placeholder:"installed"===b?"Search installed...":"Search available...",className:"w-full px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-primary)",border:"1px solid var(--border)"}})}),"installed"===b&&u&&(0,r.jsxs)("div",{className:"px-3 pb-2 flex gap-1",children:[(0,r.jsx)("input",{type:"text",value:p,onChange:e=>y(e.target.value),placeholder:"Skill name",className:"flex-1 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-primary)",border:"1px solid var(--border)"},onKeyDown:e=>"Enter"===e.key&&A(),autoFocus:!0}),(0,r.jsx)("button",{onClick:A,className:"px-2 py-1.5 rounded text-xs font-medium text-white",style:{background:"var(--accent-green)"},children:"Add"})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-0.5 px-2",children:["installed"===b&&e.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between group",children:[(0,r.jsxs)("button",{onClick:()=>s(e.id),className:"flex-1 text-left px-2 py-2 rounded-md text-sm transition-colors",style:{background:a===e.id?"var(--bg-tertiary)":"transparent"},children:[(0,r.jsx)("div",{className:"font-medium truncate",children:e.name}),(0,r.jsxs)("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[e.category,e.tags.length?" \xb7 ".concat(e.tags.join(", ")):""]})]}),(0,r.jsx)("button",{onClick:()=>D(e.id),className:"opacity-0 group-hover:opacity-100 px-1 text-xs",style:{color:"var(--accent-red)"},title:"Delete",children:"\xd7"})]},e.id)),"available"===b&&k&&(0,r.jsx)("div",{className:"px-2 py-4 text-xs text-center",style:{color:"var(--text-muted)"},children:"Loading skills from repos..."}),"available"===b&&!k&&L.map(e=>{let t=P.has(e.name),a=w.has(e.name);return(0,r.jsxs)("div",{className:"flex items-center justify-between group",children:[(0,r.jsxs)("div",{className:"flex-1 px-2 py-2 text-sm min-w-0",children:[(0,r.jsxs)("div",{className:"font-medium truncate flex items-center gap-1.5",children:[e.name,t&&(0,r.jsx)("span",{className:"text-[10px] px-1 rounded",style:{background:"var(--accent-green)",color:"white"},children:"installed"})]}),(0,r.jsx)("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:e.description||e.repo}),(0,r.jsx)("div",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:e.repo})]}),!t&&(0,r.jsx)("button",{onClick:()=>I(e),disabled:a,className:"shrink-0 px-2 py-1 rounded text-xs font-medium text-white opacity-0 group-hover:opacity-100",style:{background:"var(--accent-green)",opacity:a?.5:void 0},children:a?"...":"Install"})]},"".concat(e.repo,"/").concat(e.name))})]})]}),(0,r.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden",children:E?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border)"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-semibold",children:E.name}),(0,r.jsx)("span",{className:"text-xs ml-2",style:{color:"var(--text-muted)"},children:E.category})]}),(0,r.jsx)("button",{onClick:T,disabled:!O||d,className:"px-3 py-1.5 rounded-md text-xs font-medium text-white",style:{background:"var(--accent-green)",opacity:!O||d?.4:1},children:d?"Saving...":"Save"})]}),(0,r.jsx)("textarea",{value:n,onChange:e=>i(e.target.value),className:"flex-1 p-4 font-mono text-sm resize-none",style:{background:"var(--bg-primary)",border:"none",outline:"none"}})]}):(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",style:{color:"var(--text-muted)"},children:"available"===b?"Browse and install skills from public repositories":"Select a skill to edit"})})]})}let U=[{key:"heartbeat",label:"Heartbeat"},{key:"agents-config",label:"Config"},{key:"tools",label:"Tools"},{key:"agents",label:"Agents"},{key:"environment",label:"Environment"},{key:"soul",label:"Soul"},{key:"identity",label:"Identity"}];function M(){let[e,t]=(0,l.useState)([]),[a,s]=(0,l.useState)([]),[n,i]=(0,l.useState)(null),[d,x]=(0,l.useState)("heartbeat"),[u,m]=(0,l.useState)(""),[p,y]=(0,l.useState)(!1),[h,v]=(0,l.useState)(!1),[b,f]=(0,l.useState)("");(0,l.useEffect)(()=>{g()},[]);let g=async()=>{let e=await o("/role-configs");t(e);let a=[...new Set(e.map(e=>e.role))];s(a),!n&&a.length>0&&i(a[0])};(0,l.useEffect)(()=>{if(n&&d){var t;let a=e.find(e=>e.role===n&&e.config_type===d);m(null!=(t=null==a?void 0:a.content)?t:"")}},[n,d,e]);let j=e.find(e=>e.role===n&&e.config_type===d),k=j?u!==j.content:u.length>0,N=async()=>{if(n){y(!0);try{let e=await c("/role-configs/".concat(n,"/").concat(d),"PUT",{content:u});t(t=>{let a=t.findIndex(e=>e.role===n&&e.config_type===d);if(a>=0){let s=[...t];return s[a]=e,s}return[...t,e]})}catch(e){console.error(e.message)}finally{y(!1)}}},w=async()=>{b.trim()&&(await c("/role-configs/".concat(b,"/heartbeat"),"PUT",{content:"# ".concat(b," Heartbeat\n\nAdd your heartbeat checklist here.")}),f(""),v(!1),await g(),i(b))};return(0,r.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,r.jsxs)("div",{className:"w-[200px] shrink-0 overflow-y-auto border-r",style:{borderColor:"var(--border)",background:"var(--bg-secondary)"},children:[(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs font-bold tracking-wider",style:{color:"var(--text-muted)"},children:"ROLES"}),(0,r.jsx)("button",{onClick:()=>v(!0),className:"w-6 h-6 rounded flex items-center justify-center text-sm font-bold",style:{background:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:"+"})]}),h&&(0,r.jsxs)("div",{className:"px-3 pb-2 flex gap-1",children:[(0,r.jsx)("input",{type:"text",value:b,onChange:e=>f(e.target.value),placeholder:"Role name",className:"flex-1 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-primary)",border:"1px solid var(--border)"},onKeyDown:e=>"Enter"===e.key&&w(),autoFocus:!0}),(0,r.jsx)("button",{onClick:w,className:"px-2 py-1.5 rounded text-xs font-medium text-white",style:{background:"var(--accent-green)"},children:"Add"})]}),(0,r.jsx)("div",{className:"space-y-0.5 px-2",children:a.map(e=>(0,r.jsx)("button",{onClick:()=>i(e),className:"w-full text-left px-3 py-2 rounded-md text-sm font-medium transition-colors",style:{background:n===e?"var(--bg-tertiary)":"transparent",color:n===e?"var(--text-primary)":"var(--text-secondary)"},children:e},e))})]}),n?(0,r.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,r.jsx)("div",{className:"flex gap-0 border-b px-4",style:{borderColor:"var(--border)",background:"var(--bg-secondary)"},children:U.map(e=>(0,r.jsxs)("button",{onClick:()=>x(e.key),className:"px-3 py-2 text-sm font-medium transition-colors relative",style:{color:d===e.key?"var(--text-primary)":"var(--text-muted)"},children:[e.label,d===e.key&&(0,r.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{background:"var(--accent-green)"}})]},e.key))}),(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border-b",style:{borderColor:"var(--border)"},children:[(0,r.jsxs)("span",{className:"text-sm",style:{color:"var(--text-secondary)"},children:[n," / ",d]}),(0,r.jsx)("button",{onClick:N,disabled:!k||p,className:"px-3 py-1.5 rounded-md text-xs font-medium text-white",style:{background:"var(--accent-green)",opacity:!k||p?.4:1},children:p?"Saving...":"Save"})]}),(0,r.jsx)("textarea",{value:u,onChange:e=>m(e.target.value),className:"flex-1 p-4 font-mono text-sm resize-none",style:{background:"var(--bg-primary)",border:"none",outline:"none"}})]}):(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",style:{color:"var(--text-muted)"},children:"Select a role"})]})}function R(){let[e,t]=(0,l.useState)([]),[a,s]=(0,l.useState)(null),[n,i]=(0,l.useState)(""),[d,x]=(0,l.useState)(""),[u,m]=(0,l.useState)(!1),[p,y]=(0,l.useState)(!1),[h,v]=(0,l.useState)(""),[b,f]=(0,l.useState)(""),g=()=>{let e=b?"?search=".concat(encodeURIComponent(b)):"";o("/knowledge".concat(e)).then(t).catch(console.error)};(0,l.useEffect)(()=>{g()},[]),(0,l.useEffect)(()=>{g()},[b]);let j=e.find(e=>e.id===a);(0,l.useEffect)(()=>{j&&(i(j.content),x(j.tags.join(", ")))},[a]);let k=j&&(n!==j.content||d!==j.tags.join(", ")),N=async()=>{if(j){m(!0);try{let e=d.split(",").map(e=>e.trim()).filter(Boolean),s=await c("/knowledge","POST",{key:j.key,content:n,tags:e,from:"human"});t(e=>e.map(e=>e.id===a?s:e))}catch(e){console.error(e.message)}finally{m(!1)}}},w=async()=>{if(h.trim())try{let e=await c("/knowledge","POST",{key:h,content:"",tags:[],from:"human"});t(t=>[e,...t]),s(e.id),v(""),y(!1)}catch(e){console.error(e.message)}};return(0,r.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,r.jsxs)("div",{className:"w-[260px] shrink-0 overflow-y-auto border-r flex flex-col",style:{borderColor:"var(--border)",background:"var(--bg-secondary)"},children:[(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs font-bold tracking-wider",style:{color:"var(--text-muted)"},children:"KNOWLEDGE"}),(0,r.jsx)("button",{onClick:()=>y(!0),className:"w-6 h-6 rounded flex items-center justify-center text-sm font-bold",style:{background:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:"+"})]}),(0,r.jsx)("div",{className:"px-3 pb-2",children:(0,r.jsx)("input",{type:"text",value:b,onChange:e=>f(e.target.value),placeholder:"Search knowledge...",className:"w-full px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-primary)",border:"1px solid var(--border)"}})}),p&&(0,r.jsxs)("div",{className:"px-3 pb-2 flex gap-1",children:[(0,r.jsx)("input",{type:"text",value:h,onChange:e=>v(e.target.value),placeholder:"Key",className:"flex-1 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-primary)",border:"1px solid var(--border)"},onKeyDown:e=>"Enter"===e.key&&w(),autoFocus:!0}),(0,r.jsx)("button",{onClick:w,className:"px-2 py-1.5 rounded text-xs font-medium text-white",style:{background:"var(--accent-green)"},children:"Add"})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto space-y-0.5 px-2",children:e.map(e=>(0,r.jsx)("div",{className:"flex items-center justify-between group",children:(0,r.jsxs)("button",{onClick:()=>s(e.id),className:"flex-1 text-left px-2 py-2 rounded-md text-sm transition-colors",style:{background:a===e.id?"var(--bg-tertiary)":"transparent"},children:[(0,r.jsx)("div",{className:"font-medium truncate",children:e.key}),(0,r.jsx)("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:e.tags.length?e.tags.join(", "):"no tags"})]})},e.id))})]}),(0,r.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden",children:j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border)"},children:[(0,r.jsx)("span",{className:"font-semibold",children:j.key}),(0,r.jsx)("button",{onClick:N,disabled:!k||u,className:"px-3 py-1.5 rounded-md text-xs font-medium text-white",style:{background:"var(--accent-green)",opacity:!k||u?.4:1},children:u?"Saving...":"Save"})]}),(0,r.jsxs)("div",{className:"px-4 pt-3 pb-2",children:[(0,r.jsx)("label",{className:"text-xs font-medium",style:{color:"var(--text-muted)"},children:"Tags (comma-separated)"}),(0,r.jsx)("input",{type:"text",value:d,onChange:e=>x(e.target.value),className:"w-full px-2 py-1.5 rounded text-xs mt-1",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"}})]}),(0,r.jsx)("textarea",{value:n,onChange:e=>i(e.target.value),className:"flex-1 p-4 font-mono text-sm resize-none",style:{background:"var(--bg-primary)",border:"none",outline:"none"}})]}):(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",style:{color:"var(--text-muted)"},children:"Select a knowledge entry to edit"})})]})}function F(){let[e,t]=(0,l.useState)([]),[a,s]=(0,l.useState)(null),[n,i]=(0,l.useState)(""),[d,x]=(0,l.useState)(""),[u,m]=(0,l.useState)(""),[p,y]=(0,l.useState)(!1),[h,v]=(0,l.useState)(!1),[b,f]=(0,l.useState)("");(0,l.useEffect)(()=>{o("/documents").then(t).catch(console.error)},[]);let g=e.find(e=>e.id===a);(0,l.useEffect)(()=>{g&&(i(g.title),x(g.content),m(g.doc_type))},[a]);let j=g&&(n!==g.title||d!==g.content||u!==g.doc_type),k=async()=>{if(a){y(!0);try{let e=await c("/documents/".concat(a),"PUT",{title:n,content:d,doc_type:u});t(t=>t.map(t=>t.id===a?e:t))}catch(e){console.error(e.message)}finally{y(!1)}}},N=async()=>{if(b.trim())try{let e=await c("/documents","POST",{title:b,content:"",doc_type:"general",from:"human"});t(t=>[e,...t]),s(e.id),f(""),v(!1)}catch(e){console.error(e.message)}};return(0,r.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,r.jsxs)("div",{className:"w-[260px] shrink-0 overflow-y-auto border-r flex flex-col",style:{borderColor:"var(--border)",background:"var(--bg-secondary)"},children:[(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs font-bold tracking-wider",style:{color:"var(--text-muted)"},children:"DOCUMENTS"}),(0,r.jsx)("button",{onClick:()=>v(!0),className:"w-6 h-6 rounded flex items-center justify-center text-sm font-bold",style:{background:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:"+"})]}),h&&(0,r.jsxs)("div",{className:"px-3 pb-2 flex gap-1",children:[(0,r.jsx)("input",{type:"text",value:b,onChange:e=>f(e.target.value),placeholder:"Document title",className:"flex-1 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-primary)",border:"1px solid var(--border)"},onKeyDown:e=>"Enter"===e.key&&N(),autoFocus:!0}),(0,r.jsx)("button",{onClick:N,className:"px-2 py-1.5 rounded text-xs font-medium text-white",style:{background:"var(--accent-green)"},children:"Add"})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto space-y-0.5 px-2",children:e.map(e=>(0,r.jsx)("div",{className:"flex items-center justify-between group",children:(0,r.jsxs)("button",{onClick:()=>s(e.id),className:"flex-1 text-left px-2 py-2 rounded-md text-sm transition-colors",style:{background:a===e.id?"var(--bg-tertiary)":"transparent"},children:[(0,r.jsx)("div",{className:"font-medium truncate",children:e.title}),(0,r.jsxs)("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[e.doc_type," \xb7 ",(e=>{try{return new Date(e).toLocaleDateString()}catch(t){return e}})(e.created_at)]})]})},e.id))})]}),(0,r.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden",children:g?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border)"},children:[(0,r.jsx)("span",{className:"font-semibold",children:g.title}),(0,r.jsx)("button",{onClick:k,disabled:!j||p,className:"px-3 py-1.5 rounded-md text-xs font-medium text-white",style:{background:"var(--accent-green)",opacity:!j||p?.4:1},children:p?"Saving...":"Save"})]}),(0,r.jsxs)("div",{className:"px-4 pt-3 pb-2 flex gap-4",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("label",{className:"text-xs font-medium",style:{color:"var(--text-muted)"},children:"Title"}),(0,r.jsx)("input",{type:"text",value:n,onChange:e=>i(e.target.value),className:"w-full px-2 py-1.5 rounded text-xs mt-1",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-medium",style:{color:"var(--text-muted)"},children:"Type"}),(0,r.jsx)("input",{type:"text",value:u,onChange:e=>m(e.target.value),className:"w-full px-2 py-1.5 rounded text-xs mt-1",style:{background:"var(--bg-secondary)",border:"1px solid var(--border)"}})]})]}),(0,r.jsx)("textarea",{value:d,onChange:e=>x(e.target.value),className:"flex-1 p-4 font-mono text-sm resize-none",style:{background:"var(--bg-primary)",border:"none",outline:"none"}})]}):(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",style:{color:"var(--text-muted)"},children:"Select a document to edit"})})]})}function W(){let[e,t]=(0,l.useState)("mission"),[a,s]=(0,l.useState)([]);return(0,l.useEffect)(()=>{let e=()=>o("/agents").then(s).catch(console.error);e();let t=setInterval(e,5e3);return()=>clearInterval(t)},[]),(0,r.jsxs)("div",{className:"h-screen flex flex-col",children:[(0,r.jsx)(d,{activeView:e,onViewChange:t}),"mission"===e?(0,r.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,r.jsx)(u,{agents:a}),(0,r.jsx)(g,{}),(0,r.jsx)(N,{})]}):"config"===e?(0,r.jsx)(E,{agents:a}):"settings"===e?(0,r.jsx)(P,{}):"skills"===e?(0,r.jsx)(L,{}):"roles"===e?(0,r.jsx)(M,{}):"knowledge"===e?(0,r.jsx)(R,{}):"documents"===e?(0,r.jsx)(F,{}):null]})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=5892)),_N_E=e.O()}]);